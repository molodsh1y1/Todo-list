{% extends 'base.html' %}

{% block content %}
  <h1>TODO list <a href="{% url 'todo:task-create' %}" class="btn btn-primary float-end">Add task</a></h1>
  {% if task_list %}
    <ul>
      {% for task in task_list %}
        <li>
          <h3>
            <strong>{{ task.content }}</strong>
            {% if task.is_done %}
              <span class="text-success">Done</span>
              <a href="{% url 'todo:toggle-task-status' pk=task.id %}" class="btn btn-secondary float-end">Undo</a>
            {% else %}
              <span class="text-danger">Not done</span>
              <a href="{% url 'todo:toggle-task-status' pk=task.id %}" class="btn btn-success float-end">Complete</a>
            {% endif %}
          </h3>
          <p>
            Created: {{ task.created_at }}
            {% if task.deadline and task.deadline >= datetime_now %}
              <span class="text-danger">{{ task.deadline }}</span>
            {% endif %}
          </p>
          <p>
            <i>
              Tags:
              {% for tag in task.tags.all %}
                {{ tag.name }}{% if not forloop.last %}, {% endif %}
                <a href="{% url 'todo:tag-update' pk=tag.id %}">Update</a>
                <a href="{% url 'todo:tag-delete' pk=tag.id %}">Delete</a>
              {% endfor %}
            </i>
          </p>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No tasks found.</p>
  {% endif %}
{% endblock %}
